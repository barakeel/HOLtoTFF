\section{Vérification des preuves \tff}
\label{sec:traces}
%Les travaux présentés dans cette partie sont en cours de développement.

Jusqu'ici, le prouveur externe est utilisé par \holfour comme un
oracle: s'il résout le problème traduit, celui-ci est ajouté à \holfour
comme un axiome. Nous n'avons donc aucune garantie que son raisonnement,
et donc l'axiome ajouté, sont corrects.

Pour utiliser des prouveurs externes sans compromettre la correction de
\holfour, nous utilisons l'approche \emph{sceptique} consistant à
vérifier en \holfour les traces éventuellement générées par ces
prouveurs. Pour conserver la généricité, nous vérifions des traces
fournies dans le format \tff.

Outre offrir plus de garanties à \holfour, la vérification de traces
\tff peut être utilisés pour garantir les résultats donnés par des
prouveurs du premier ordre lors d'autres utilisations.


\subsection{Vérification des preuves}
\subsubsection{Parsing}
Les traces supportées actuellement par notre tactiques sont les fichiers
au format \tff contenant uniquement des clauses. Lorsque le parsing
s'effectue à partir d'un problème généré par notre traduction, les
variables, constantes et types du fichier de trace sont mises en
correspondance avec celles du problème de départ à l'aide des
dictionnaires injectifs \holfour. (\todo il faudra avoir expliqué ce que c'est).


\subsubsection{Rejouer la preuve}

Les tactiques \metistac et \coopertac (une implémentation de
l'algorithme de Cooper pour l'arithmétique de
Presburger~\cite{Norrish03completeinteger}) sont utilisées conjointement
pour rejouer les étapes de la preuve, respectivement en fonction de la
nature de chacune des étapges.

Les deux tactiques utilisées ici ayant été prouvées correctes [\todo
ref], cela permet d'importer des théorèmes prouvés par des prouveurs
automatiques fournissant des traces au format \tff dans \holfour sans en
compromettre sa correction.

Cette utilisation de \metistac à chaque petite étape propositionnelle de
la preuve ne peut être efficace, mais permet de fournir un premier
prototype permettant d'intégrer un prouveur externe de manière sceptique
dans \holfour.


\subsection{Application à \beagle}

Nous appliquons ce procédé à la tactique \beagletac, afin d'implanter
complètement le schéma de la \textsc{Figure}~\ref{fig:beagletac}. Cela
nécessite tout d'abord de la part de \beagle d'être capable de générer
des traces au format \tff, ce qui peut être fait de manière assez simple
étant donné son fonctionnement. Nous expliquons de manière succincte
comment procéder, avant de présenter notre prototype de tactique
\beagletac complète sur un exemple.


\subsubsection{Génération de traces par Beagle}
\todo Je propose de ne pas parler de $split$, vu que ça ne semble pas
encore très clair alors que je pense que ça n'apporte pas grande chose
au papier.

La boucle principale de \beagle maintient à jour deux ensembles de
clauses, comme le montre le schéma de la
\textsc{Figure}~\ref{fig:fonctionnement_beagle}. À chaque itération,
\beagle sélectionne une clause dans le nouvel ensemble de clauses,
l'ajoute à l'ancien ensemble de clauses, puis en déduit de nouvelles
clauses qui sont ajoutées au nouvel ensemble. Les clauses exportées dans
nos traces sont donc celles de l'ancien ensemble, afin de ne garder que
les étapes de la preuve qui ont été utilisées\footnote{Il est parfois
  nécessaires d'ajouter quelques étapes manquantes, comme la déduction
  de la clause vide lors d'un raisonnement par l'absurde.}.

\begin{figure}[!h]
\begin{center}
\begin{tikzpicture}[auto]
  % Place nodes
  \node [cloud] (NCS) {nouvel ensemble};
  \node [cloud, fill=white, above of=NCS, node distance = 1.5cm] (init) {fichier TFF};
  \node [label = 2, cloud, below of=NCS, node distance = 2cm] (OCS) {ancien ensemble};
  % Draw edges
  \draw[-to,black,ultra thick] (NCS.east) to [out=0,in=0] node[name=down]{1} (OCS.east) ;
  \draw[-to,black,ultra thick] (OCS.west) to [out=180,in=180] node[name=up]{3} (NCS.west)  ;
  \draw[-to,black,ultra thick] (init) -- node[name=what]{parsing et normalisation} (NCS)  ;
  % Place boxes
  \node [block, right of=down, node distance=1.5cm] (rightbox)
  {Transfère une clause};
  \node [block, below of=OCS, node distance=1.5cm] (downbox)
  {Applique les règles possibles};
  \node [block, left of=up, node distance=1.5cm] (leftbox)
  {Transfère les clauses créées};
  \node [cloud, fill=white, below of=rightbox, node distance=2.5cm] (trace){fichier trace};
  \draw [-to,black,ultra thick] (down.west) to [out=270,in=90] (trace)  ;
\end{tikzpicture}
\caption{Boucle principale de \beagle}
\label{fig:fonctionnement_beagle}
\end{center}
\end{figure}

\subsubsection{Description sur une expérience}
% Exemple.

\todo
 Voici les étapes d'une expérience
 Fichier preuve:
 Représentation interne à HOL
 rejouage étape par étape de la preuve.





